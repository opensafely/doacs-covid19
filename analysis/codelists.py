from cohortextractor import (
    codelist_from_csv,
    codelist,
)

# DOACs
doac_codes = codelist_from_csv(
    "codelists/opensafely-direct-acting-oral-anticoagulants-doac.csv",
    system="snomed",
    column='id',
    category_column="bnf_code",
)
doac_chemical = codelist_from_csv(
    "codelists/opensafely-direct-acting-oral-anticoagulants-doac.csv",
    system="snomed",
    column='id',
    category_column="chemical",
)

af_codes = codelist_from_csv(
    "codelists/nhsd-primary-care-domain-refsets-afib_cod.csv",
    system="snomed",
)

#  Serum creatinine
creatinine_codes = codelist(
    ["1000001000000100", 
"1000011000000100", 
"1000021000000100", 
"1000031000000100", 
"1000041000000100", 
"1000051000000100", 
"1000061000000100", 
"1000071000000100", 
"1000081000000100", 
"1000091000000100", 
"1000101000000100", 
"1000111000000100", 
"1000121000000100", 
"1000131000000100", 
"1000141000000100", 
"1000391000000100", 
"1000411000000100", 
"1000421000000100", 
"1000431000000100", 
"1000611000000100", 
"1000731000000100", 
"1000981000000100", 
"1000991000000100", 
"1001011000000100", 
"1001711000000100", 
"1001721000000100", 
"1001731000000100", 
"1002131000000100", 
"1002181000000100", 
"1002361000000100", 
"1002601000000100", 
"1002621000000100", 
"1002981000000100", 
"1003271000000100", 
"1004391000000100", 
"1005581000000100", 
"1006221000000100", 
"1006501000000100", 
"1006631000000100", 
"1007751000000100", 
"1007901000000100", 
"1010391000000100", 
"1011301000000100", 
"1011441000000100", 
"1011451000000100", 
"1011481000000100", 
"1011491000000100", 
"1011911000000100", 
"1013731000000100", 
"1014861000000100", 
"1015641000000100", 
"1015971000000100", 
"1015981000000100", 
"1015991000000100", 
"1016121000000100", 
"1017061000000100", 
"1018021000000100", 
"1018051000000100", 
"1018061000000100", 
"1019801000000100", 
"1020021000000100", 
"1020291000000100", 
"1021491000000100", 
"1021501000000100", 
"1021511000000100", 
"1021521000000100", 
"1021831000000100", 
"1023491000000100", 
"1026891000000100", 
"1026901000000100", 
"1026911000000100", 
"1027041000000100", 
"1027791000000100", 
"1027951000000100", 
"1027961000000100", 
"1028131000000100", 
"1028271000000100", 
"1028391000000100", 
"1028731000000100", 
"1028941000000100", 
"1029411000000100", 
"1029421000000100", 
"1029581000000100", 
"1029591000000100", 
"1029601000000100", 
"1029611000000100", 
"1029621000000100", 
"1029641000000100", 
"1029651000000100", 
"1029661000000100", 
"1029671000000100", 
"1029941000000100", 
"1029951000000100", 
"1029961000000100", 
"1029971000000100", 
"1029981000000100", 
"1029991000000100", 
"1030051000000100", 
"1030321000000100", 
"1030331000000100", 
"1030341000000100", 
"1030351000000100", 
"1030361000000100", 
"1030371000000100", 
"1030381000000100", 
"1030391000000100", 
"1030401000000100", 
"1030421000000100", 
"1030431000000100", 
"1030441000000100", 
"1030471000000100", 
"1030671000000100", 
"1030991000000100", 
"1031011000000100", 
"1031471000000100", 
"1031671000000100", 
"1031681000000100", 
"1031841000000100", 
"1031851000000100", 
"1031861000000100", 
"1031871000000100", 
"1031881000000100", 
"1031891000000100", 
"1031901000000100", 
"1031921000000100", 
"1032061000000100", 
"1106601000000100", 
"1107001000000100", 
"1107011000000100", 
"1107411000000100", 
"1109421000000100", 
"1109431000000100", 
"1109441000000100", 
"1109451000000100", 
#"113075003", 
"15373003", 
"168154007", 
"275792000", 
"313822004", 
"857971000000104", 
"963601000000106", 
"963621000000102", 
"968191000000100", 
"994341000000101", 
"994501000000108", 
"994511000000105", 
"996231000000108", 
"997801000000104", 
"997811000000102", 
"997821000000108", 
"997831000000105", 
"997841000000101", 
"997851000000103", 
"997861000000100", 
"997871000000107", 
"997881000000109", 
"997911000000109", 
"997921000000103", 
"997931000000101", 
"997941000000105", 
"998491000000109", 
"999871000000102", 
"999881000000100", 
"999901000000102", 
"999911000000100", 
"999931000000108", 
"999941000000104", 
"999971000000105", 
"999981000000107", 
"999991000000109"],
    system="snomed",
)

# eGFR
egfr_codes = codelist(
    ["1011481000000100", 
"1011491000000100", 
"1020291000000100", 
"1107411000000100", 
"166181000000100", 
"167182002", 
"167183007", 
"222521000000103", 
"231131000000104", 
"444336003", 
"703502005", 
"791801000000102", 
"80274001", 
"857971000000104", 
"963601000000106", 
"963621000000102", 
"996231000000108"],
    system="snomed",
)

# Creatinine clearance test
crcl_codes = codelist(
    ["167181009", 
"167182002", 
"167183007", 
"250735000", 
"395680003", 
"442238003", 
"442407001", 
"442723000", 
"784580008", 
"968191000000100"],
    system="snomed",
)

# certain p-gp inhibitors ciclosporin 80906007, dronedarone 443310000, erthromycin 30427009, ketoconazole 40232005
pgpi_codes = codelist(
    ["80906007", "443310000", "30427009", "40232005"],
    system="snomed",
)

# verapamil 47898004
verapamil_codes = codelist(
    ["47898004"],
    system="snomed",
)

# gastritus, esophagitus, gastroesophageal refulx or increased risk of bleeding
contra_codes = codelist(
    ["1027000", 
"1052296002", 
"10628871000119100", 
"10628911000119100", 
"1086791000119100", 
"109814008", 
"10999201000119100", 
"110433005", 
"111843007", 
"123625002", 
"123634007", 
"1240571000000100", 
"12463005", 
"125296000", 
"125297009", 
"125298004", 
"125299007", 
"125300004", 
"125301000", 
"12574004", 
"135830006", 
"13713005", 
"142961000119108", 
"15445004", 
"15556001", 
"15643101000119100", 
"15749591000119100", 
"15926411000119100", 
"165388009", 
"16872008", 
"1824008", 
"186143000", 
"186272008", 
"18935007", 
"189411005", 
"19137006", 
"196731005", 
"196735001", 
"196740009", 
"197011006", 
"197012004", 
"197028009", 
"2043009", 
"21871000119107", 
"22084008", 
"22304002", 
"22341001", 
"230314007", 
"234442002", 
"234444001", 
"234445000", 
"235595009", 
"235654003", 
"235655002", 
"235656001", 
"235657005", 
"235659008", 
"235660003", 
"235661004", 
"235662006", 
"235663001", 
"235664007", 
"236063005", 
"2367005", 
"240332005", 
"245754007", 
"24789006", 
"248253003", 
"25374005", 
"25458004", 
"26006005", 
"26029002", 
"266433003", 
"266435005", 
"266451002", 
"266503008", 
"266504002", 
"26713004", 
"26727009", 
"276527006", 
"27858009", 
"28293008", 
"283876006", 
"283877002", 
"285344007", 
"28878004", 
"30755009", 
"308119005", 
"312088007", 
"3308008", 
"33344008", 
"33687004", 
"35023000", 
"35223008", 
"359613008", 
"359651008", 
"35974005", 
"359804008", 
"360375007", 
"36789003", 
"371101003", 
"371132002", 
"37693008", 
"37842001", 
"396337009", 
"396339007", 
"409506009", 
"415822001", 
"416482004", 
"41788008", 
"421454008", 
"421983003", 
"42541005", 
"425949001", 
"426199009", 
"42740008", 
"429300008", 
"438360006", 
"438372000", 
"438373005", 
"438599002", 
"438792009", 
"440820004", 
"440866009", 
"440867000", 
"440868005", 
"440993008", 
"441006000", 
"441190003", 
"441191004", 
"441192006", 
"444926003", 
"446569001", 
"448128007", 
"4556007", 
"46763001", 
"49410006", 
"49781004", 
"50874004", 
"51338006", 
"51670003", 
"52305004", 
"52453001", 
"53954009", 
"5480000", 
"57419008", 
"57433008", 
"58417008", 
"60002000", 
"60871005", 
"61424003", 
"62473009", 
"63137003", 
"63924002", 
"66160001", 
"66329006", 
"67375008", 
"69776003", 
"698352000", 
"699323007", 
"70622003", 
"707222009", 
"707352004", 
"708164002", 
"708165001", 
"713180002", 
"713186008", 
"713570009", 
"71583005", 
"717846004", 
"717847008", 
"717861003", 
"71987003", 
"720401009", 
"723096000", 
"723097009", 
"723098004", 
"724517005", 
"72950008", 
"735459007", 
"73832007", 
"7399006", 
"74211002", 
"74361008", 
"7475005", 
"75753009", 
"765756007", 
"76761008", 
"78160009", 
"78195007", 
"789697006", 
"80018001", 
"84568007", 
"8493009", 
"85010006", 
"860887000", 
"860889002", 
"89030000", 
"89538001", 
"89790007", 
"97801000119102"],
    system="snomed",
)

# Weight
weight_codes = codelist(
    ["27113001"], #, "162763007"
    system="snomed",
)

# Height
height_codes = codelist(
    ["271603002"], #, "162755006"
    system="snomed",
)

# Ethnicity codes
eth2001 = codelist_from_csv(
    "codelists/primis-covid19-vacc-uptake-eth2001.csv",
    system="snomed",
    column="code",
    category_column="grouping_6_id",
)

# Any other ethnicity code
non_eth2001 = codelist_from_csv(
    "codelists/primis-covid19-vacc-uptake-non_eth2001.csv",
    system="snomed",
    column="code",
)

# Ethnicity not given - patient refused
eth_notgiptref = codelist_from_csv(
    "codelists/primis-covid19-vacc-uptake-eth_notgiptref.csv",
    system="snomed",
    column="code",
)

# Ethnicity not stated
eth_notstated = codelist_from_csv(
    "codelists/primis-covid19-vacc-uptake-eth_notstated.csv",
    system="snomed",
    column="code",
)

# Ethnicity no record
eth_norecord = codelist_from_csv(
    "codelists/primis-covid19-vacc-uptake-eth_norecord.csv",
    system="snomed",
    column="code",
)

# Are they registered as a carer, a person caring for a dependant
carer = codelist_from_csv(
    "codelists/primis-covid19-vacc-uptake-carer.csv",
    system="snomed",
    column="code",
)